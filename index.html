<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ø³Ø¤Ø§Ù„Ø§Øª Ù…ÛŒÙ„Ø§Ø¯  </title>
<style>
  :root{
    --card-bg:#ffffff;
    --accent:#4caf50;
    --accent-2:#2196f3;
    --muted:#666;
    --danger:#e91e63;
    --radius:12px;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,'Helvetica Neue',Arial; background:linear-gradient(180deg,#f7f9fc,#eef4fb);color:#111}

  /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ù…Ø±Ú©Ø²ÛŒ */
  .wrap{max-width:1000px;margin:20px auto;padding:16px}

  /* Ú©Ø§Ø±Øª Ø³ÙˆØ§Ù„ */
  #box{background:var(--card-bg);border-radius:var(--radius);padding:22px;box-shadow:0 6px 20px rgba(16,24,40,0.08);} 
  #welcome{background:#fff7; padding:12px;border-radius:10px;margin-bottom:12px;font-weight:700;text-align:center}

  h2#question{margin:0 0 14px;font-size:20px;line-height:1.3}
  #msg{min-height:22px;margin-top:8px;color:var(--muted);font-weight:600}

  /* Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§: Ú¯Ø±ÛŒØ¯ Ø±ÙˆÛŒ Ø¯Ø³Ú©ØªØ§Ù¾ØŒ Ø³ØªÙˆÙ† Ø±ÙˆÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
  .options{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .options.full{grid-template-columns:1fr}
  .options button{padding:12px 14px;border-radius:10px;border:0;background:var(--accent);color:#fff;font-size:16px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.06);transition:transform .12s,opacity .12s}
  .options button:hover{transform:translateY(-2px)}
  .options button.disabled{background:#bbb;cursor:not-allowed;opacity:0.8}

  /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ */
  .actions{display:flex;gap:10px;align-items:center;margin-top:16px}
  .actions .primary{background:var(--accent-2);color:#fff;padding:10px 14px;border-radius:10px;border:0;cursor:pointer}
  .actions .ghost{background:transparent;border:1px solid #e6e6e6;padding:10px 14px;border-radius:10px;cursor:pointer}

  textarea{width:100%;min-height:110px;padding:12px;border-radius:10px;border:1px solid #e6e9ef;font-size:15px}

  /* Ø¯Ú©Ù…Ù‡ Ø§Ø¯Ù…ÛŒÙ† */
  #adminBtn{position:fixed;left:18px;top:18px;background:var(--danger);color:#fff;border:0;padding:10px 12px;border-radius:10px;box-shadow:0 6px 18px rgba(233,30,99,0.12);cursor:pointer;z-index:40}

  /* Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª â€” Ù…ÙˆØ¯Ø§Ù„ Ú©Ø§Ù…Ù„ */
  #adminOverlay{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center;z-index:50;padding:20px}
  #adminPanel{background:var(--card-bg);width:100%;max-width:980px;border-radius:12px;padding:18px;box-shadow:0 20px 60px rgba(2,6,23,0.2);max-height:90vh;overflow:auto}
  #adminHeader{display:flex;justify-content:space-between;align-items:center;gap:12px}
  #resultsBox table{width:100%;border-collapse:collapse;margin-top:12px}
  #resultsBox th,#resultsBox td{border:1px solid #eee;padding:8px;text-align:right;font-size:14px}
  #resultsBox pre{white-space:pre-wrap;margin:0;font-family:inherit}

  /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
  @media (max-width:700px){
    h2#question{font-size:18px}
    .options{grid-template-columns:1fr;}
    #box{padding:16px}
    #adminBtn{left:10px;top:10px;padding:9px}
  }
  @media (max-width:420px){
    .actions{flex-direction:column;align-items:stretch}
    .options button{font-size:15px;padding:12px}
    textarea{min-height:90px}
  }
</style>
</head>
<body>

<button id="adminBtn">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</button>

<div class="wrap">
  <div id="box">
    <div id="welcome">Ø·Ø±Ù†Ù… Ø®ÙˆØ´Ú¯Ù„Ù‡ â€” Ø®ÙˆØ´ Ø§ÙˆÙ…Ø¯ÛŒ ğŸŒ¸</div>
    <h2 id="question">...</h2>
    <div id="options" class="options"></div>

    <div class="actions">
      <div id="msg"></div>
      <button id="nextBtn" class="primary" style="display:none" onclick="nextQuestion()">Ø¨Ø±Ùˆ Ø¨Ø¹Ø¯ÛŒ</button>
    </div>
  </div>
</div>

<!-- Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø¯Ø§Ù„ -->
<div id="adminOverlay">
  <div id="adminPanel">
    <div id="adminHeader">
      <h3>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª</h3>
      <div>
        <button id="refreshBtn" class="ghost">Ø¨Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯</button>
        <button id="closeAdmin">Ø¨Ø³ØªÙ†</button>
      </div>
    </div>
    <div id="resultsBox">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
  </div>
</div>

<script>
// ====== Ø³ÙˆØ§Ù„Ø§Øª Ùˆ Ø±ÙØªØ§Ø±Ù‡Ø§ ======
let step = 0; let answers = {};
const q = [
  {text:"Ø®ÙˆØ¯Øª Ø±Ùˆ Ø¯ÙˆØ³Øª Ø¯Ø§Ø±ÛŒØŸ", options:["Ø¨Ù„Ù‡","Ø®ÛŒØ±"], action(c){msg.innerText = "Ù…ÛŒØ¯ÙˆÙ†Ù… Ù…ÛŒÙ„Ø§Ø¯ Ø±Ùˆ Ø¯ÙˆØ³Øª Ø¯Ø§Ø±ÛŒğŸ˜";}},
  {text:"Ú©ÛŒ Ø®ÙˆØ´Ú¯Ù„ ØªØ±Ù‡ØŸ", options:["Ù…ÛŒÙ„Ø§Ø¯","Ø·Ø±Ù†Ù…"], action(c){msg.innerText = "ØµØ¯ Ø¯Ø± ØµØ¯ Ù…ÛŒÙ„Ø§Ø¯ğŸ˜";}},
  {text:"Ø´ØºÙ„ Ù…ÛŒÙ„Ø§Ø¯ Ú†ÛŒÙ‡ØŸ", options:["ÙØ±ÙˆØ´ Ú¯Ù†Ø¯Ù…","ÙØ±ÙˆØ´ Ø¬Ùˆ","ÙØ±ÙˆØ´ Ø¯ÙˆØªØ§Ø´"], action(c){msg.innerText = (c=="ÙØ±ÙˆØ´ Ø¬Ùˆ")?"Ø¹Ø¬Ø¨ÛŒ Ø¢ÙØ±ÛŒÙ†ğŸ˜…":"Ø§ÙˆÚ©ÛŒğŸ¤£";}},
  {text:"Ø§Ú¯Ù‡ Ù…ÛŒÙ„Ø§Ø¯ ØºÛŒØ¨ Ø¨Ø´Ù‡ Ø¯Ù„Øª ØªÙ†Ú¯ Ù…ÛŒØ´Ù‡ØŸ", options:["Ø¨Ù„Ù‡","Ø®ÛŒØ±"], action(c){}},
  {text:"Ø¨Ù‡ Ù†Ø¸Ø±Øª Ù…ÛŒÙ„Ø§Ø¯ Ú†Ø·ÙˆØ± Ù¾Ø³Ø±ÛŒÙ‡ØŸ", options:["Ø³Ø§Ø¯Ù‡","Ù…Ù‡Ø±Ø¨ÙˆÙ†","Ø¨Ø§Ø­Ø§Ù„ Ùˆ Ù¾Ø§ÛŒÙ‡","Ù¾Ø³Ø± Ø¨Ø¯ÛŒ"], action(c){}},
  {text:"Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ø±Ø§Ø¨Ø·Ù‡ Ùˆ Ø¯ÛŒØª Ø¨Ø§ Ù…ÛŒÙ„Ø§Ø¯ Ù‚Ø¨ÙˆÙ„ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØŸ", options:["Ø¨Ù„Ù‡","Ø®ÛŒØ±"], action(c){ if(c=="Ø¨Ù„Ù‡"){ msg.innerText="Ø¢ÙØ±ÛŒÙ† Ø¨Ù‡ ØªÙˆ ØªØµÙ…ÛŒÙ… Ø®ÙˆØ¨ÛŒ Ú¯Ø±ÙØªÛŒğŸ˜"; /* disable Ø®ÛŒØ± if desired */ } else { msg.innerText = "Ø¨Ø§Ø´Ù‡ ÙˆÙ„ÛŒ Ø§ÛŒÙ† Ø±Ø³Ù…Ø´ Ù†Ø¨ÙˆØ¯ Ú¯Ù†Ø§Ù‡ Ø¯Ø§Ø±Ù‡â˜¹ï¸"; } }},
  {text:"Ø§Ú¯Ù‡ Ù¾ÛŒØºØ§Ù… Ø®Ø§ØµÛŒ Ø¨Ø±Ø§Ø´ Ø¯Ø§Ø±ÛŒ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³:", options:[], action(c){} }
];

const question = document.getElementById('question');
const optionsEl = document.getElementById('options');
const msg = document.getElementById('msg');
const nextBtn = document.getElementById('nextBtn');

function renderOptions(){
  msg.innerText=''; nextBtn.style.display='none';
  const data = q[step];
  question.innerText = data.text;
  optionsEl.innerHTML = '';

  // Ø§Ú¯Ø± Ø¢Ø®Ø±ÛŒÙ† Ø³Ø¤Ø§Ù„ Ø§Ø³ØªØŒ Ú©Ø§Ø¯Ø± Ù…ØªÙ† Ù†Ø´Ø§Ù† Ø¨Ø¯Ù‡
  if(step === q.length - 1){
    const ta = document.createElement('textarea'); ta.placeholder='Ù¾ÛŒØ§Ù…...';
    const send = document.createElement('button'); send.innerText='Ø§Ø±Ø³Ø§Ù„'; send.className='primary';
    send.onclick = ()=>{ answers[step] = ta.value||''; finishAndSend(); };
    optionsEl.appendChild(ta); optionsEl.appendChild(send);
    return;
  }

  // Ø§Ú¯Ø± ØªØ¹Ø¯Ø§Ø¯ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ 1 ÛŒØ§ Ø¨ÛŒØ´ØªØ± â€” Ú†ÛŒØ¯Ù…Ø§Ù† ØªÚ© Ø³ØªÙˆÙ†Ù‡ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ handled by CSS
  q[step].options.forEach(op=>{
    const b = document.createElement('button'); b.innerText = op;
    b.onclick = ()=>{ if(b.disabled) return; answers[step]=op; data.action(op); nextBtn.style.display='inline-block'; };
    optionsEl.appendChild(b);
  });
}

function nextQuestion(){ if(step < q.length-1){ step++; renderOptions(); } }

// Ø§Ø±Ø³Ø§Ù„ Ù†Ù‡Ø§ÛŒÛŒ Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ø±ÙˆÛŒ Ø³Ø±ÙˆØ±
async function finishAndSend(){
  msg.innerText = 'Ø¯Ø± Ø­Ø§Ù„ Ø°Ø®ÛŒØ±Ù‡ Ø±ÙˆÛŒ Ø³Ø±ÙˆØ±...';
  
  // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² JSONBin.io - Ø¨Ø§ÛŒØ¯ API Key Ø®ÙˆØ¯ØªÙˆÙ† Ø±Ùˆ Ø¨Ú¯ÛŒØ±ÛŒØ¯ Ø§Ø² jsonbin.io
  const API_KEY = '$2a$10$LMWKJ0NZD6LpLfOauBNRiuvBOobYArw7cW0UcQDhLWo6fksqBsV82';
  const BIN_ID = '69380b3dd0ea881f401ccb01';
  
  try{
    // Ø§Ø¨ØªØ¯Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ Ø±Ø§ Ø¨Ø®ÙˆØ§Ù†ÛŒØ¯
    const getRes = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
      headers: {'X-Access-Key': API_KEY}
    });
    const currentData = await getRes.json();
    const allResults = currentData.record.results || [];
    
    // Ø¯Ø§Ø¯Ù‡ Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯
    allResults.push({
      time: new Date().toISOString(),
      answers: answers
    });
    
    // Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯
    const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
        'X-Access-Key': API_KEY
      },
      body: JSON.stringify({results: allResults})
    });
    
    const j = await res.json();
    if(j.record) {
      msg.innerText = 'Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ âœ”';
    } else {
      msg.innerText = 'Ø°Ø®ÛŒØ±Ù‡ Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯';
    }
  }catch(e){
    console.error(e);
    msg.innerText = 'Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±';
  }
}

// ====== Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø¯Ø§Ù„ ======
const adminBtn = document.getElementById('adminBtn');
const adminOverlay = document.getElementById('adminOverlay');
const adminPanel = document.getElementById('adminPanel');
const closeAdmin = document.getElementById('closeAdmin');
const resultsBox = document.getElementById('resultsBox');
const refreshBtn = document.getElementById('refreshBtn');

adminBtn.onclick = async ()=>{
  const pass = prompt('Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ØŸ'); if(pass !== 'milad3070') return alert('Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡!');
  adminOverlay.style.display = 'flex';
  await loadResults();
};
closeAdmin.onclick = ()=>{ adminOverlay.style.display = 'none'; };
refreshBtn.onclick = ()=> loadResults();

async function loadResults(){
  resultsBox.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ Ø®ÙˆØ§Ù†Ø¯Ù†...';
  
  const API_KEY = '$2a$10$LMWKJ0NZD6LpLfOauBNRiuvBOobYArw7cW0UcQDhLWo6fksqBsV82';
  const BIN_ID = '69380b3dd0ea881f401ccb01';
  
  try{
    const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
      headers: {'X-Access-Key': API_KEY}
    });
    const data = await res.json();
    const results = data.record.results || [];
    
    if(results.length === 0){
      resultsBox.innerHTML = '<div>Ù†ØªÛŒØ¬Û€ Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡â€ŒØ§ÛŒ Ù†ÛŒØ³Øª</div>';
      return;
    }
    
    let html = '<table><thead><tr><th>#</th><th>ØªØ§Ø±ÛŒØ®</th><th>Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§</th></tr></thead><tbody>';
    results.reverse().forEach((item, idx) => {
      const date = new Date(item.time).toLocaleString('fa-IR');
      const answersText = JSON.stringify(item.answers, null, 2);
      html += `<tr><td>${idx+1}</td><td>${date}</td><td><pre>${escapeHtml(answersText)}</pre></td></tr>`;
    });
    html += '</tbody></table>';
    resultsBox.innerHTML = html;
  }catch(e){
    console.error(e);
    resultsBox.innerHTML = 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù†ØªØ§ÛŒØ¬';
  }
}

function escapeHtml(str){ return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

// Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
renderOptions();
</script>
</body>
</html>